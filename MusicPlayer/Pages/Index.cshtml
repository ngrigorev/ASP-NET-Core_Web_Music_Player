@page
@model IndexModel
@{
    ViewData["Title"] = "Home page";
}


<h1 class="display-4">Welcome to YouPlay</h1>
<p>Learn about <a href="https://docs.microsoft.com/aspnet/core">building Web apps with ASP.NET Coreset</a>.</p>

<div class="row bg-dark text-light" style="padding: 2rem">
    <div class="col-9">
        <div class="row align-items-start">
            <div class="col-2">
                <a role="button" onclick="wavesurfer.playPause()" style="cursor: pointer;">
                    <span style="font-size: 4rem; color: Tomato;">
                        <i class="fas fa-play-circle"></i>
                    </span>
                </a>
            </div>
            <div class="col-6">
                <h2>
                    GROS SON SALLE
                </h2>
                <h4>
                    Booba
                </h4>
            </div>
            <span style="font-size: 1.8rem;">
                <a role="button" onclick="wavesurfer.toggleMute()" style="cursor: pointer;">
                    <i class="fas fa-volume-mute"></i>
                </a>
                <input id="volume" type="range" min="0" max="1" value="1" step="0.05">
            </span>
        </div>
        <div id="waveform">
            <div id="current" class="text-monospace" style="position: absolute; left: 18px; bottom: 0px; background-color: black; padding-left: 4px; padding-right: 4px">0:00</div>
            <div id="duration" class="text-monospace" style="position: absolute; right: 18px; bottom: 0px; background-color: black; padding-left: 4px; padding-right: 4px">0:00</div>
        </div>
    </div>
    <div class="col-3 bg-light" style="position: relative; width: 100%; padding-top: 100%;">
        
    </div>
</div>

<script>
    // Set-up for wavesurfer
    var wavesurfer = WaveSurfer.create({
        container: document.querySelector('#waveform'),
        waveColor: 'White',
        progressColor: 'Tomato',
        barWidth: 2,
        cursorWidth: 0,
        responsive: true
    });

    wavesurfer.setVolume(0.4);
    document.querySelector('#volume').value = 0.4;

    var volumeInput = document.querySelector('#volume');
    var onChangeVolume = function (e) {
      wavesurfer.setVolume(e.target.value);
      console.log(e.target.value);
    };

    volumeInput.addEventListener('input', onChangeVolume);
    volumeInput.addEventListener('change', onChangeVolume);

    // Loading audio file
    wavesurfer.load('audio/bell.mp3');

    // Take a float value of time return to the 'm:ss' format
    var formatTime = function (timeValue) {
        return Math.trunc(timeValue / 60) + ':' + ('0' + Math.trunc(timeValue % 60)).slice(-2)
    }

    // Update current sound duration
    wavesurfer.on('ready', function () {
        document.getElementById("duration").innerHTML = formatTime(wavesurfer.getDuration())
    });

    // Update current sound cursor
    wavesurfer.on('audioprocess', function () {
        document.getElementById("current").innerHTML = formatTime(wavesurfer.getCurrentTime())
    });
</script>
